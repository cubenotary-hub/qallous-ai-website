<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sage CEO Analytics Dashboard - Fortune 500 AI Advisor Metrics</title>
    <style>
        :root {
            --bg-dark: #0a0e1a;
            --bg-card: #151b2e;
            --bg-card-hover: #1a2238;
            --accent-primary: #00ffff;
            --accent-secondary: #ff00ff;
            --accent-success: #00ff88;
            --accent-warning: #ffaa00;
            --accent-danger: #ff3366;
            --text-primary: #ffffff;
            --text-secondary: #a0aec0;
            --border-color: #2d3748;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Animated background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0.1;
            background: 
                radial-gradient(circle at 20% 50%, var(--accent-primary) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, var(--accent-secondary) 0%, transparent 50%);
            animation: bgShift 20s ease-in-out infinite;
        }

        @keyframes bgShift {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(5deg); }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .dashboard-header {
            background: linear-gradient(135deg, var(--bg-card) 0%, var(--bg-card-hover) 100%);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0, 255, 255, 0.1);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .header-left h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .header-subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid var(--accent-success);
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 600;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            background: var(--accent-success);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .stat-card:hover {
            background: var(--bg-card-hover);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.2);
        }

        .stat-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }

        .stat-trend {
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .trend-up {
            color: var(--accent-success);
        }

        .trend-down {
            color: var(--accent-danger);
        }

        /* Charts Section */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 25px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .chart-subtitle {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Metrics Table */
        .metrics-table {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 25px;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead th {
            text-align: left;
            padding: 15px;
            background: var(--bg-dark);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 1px;
            color: var(--accent-primary);
            border-bottom: 2px solid var(--border-color);
        }

        tbody tr {
            border-bottom: 1px solid var(--border-color);
            transition: background 0.2s;
        }

        tbody tr:hover {
            background: var(--bg-card-hover);
        }

        tbody td {
            padding: 15px;
        }

        .topic-tag {
            display: inline-block;
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid var(--accent-primary);
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            margin-right: 5px;
        }

        .confidence-bar {
            width: 100%;
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-success), var(--accent-primary));
            transition: width 0.3s ease;
        }

        /* Real-time Feed */
        .realtime-feed {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 25px;
            max-height: 500px;
            overflow-y: auto;
        }

        .feed-item {
            padding: 15px;
            margin-bottom: 10px;
            background: var(--bg-dark);
            border-radius: 10px;
            border-left: 3px solid var(--accent-primary);
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .feed-time {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .feed-query {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .feed-meta {
            font-size: 0.85rem;
            color: var(--text-secondary);
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        /* Refresh Button */
        .refresh-btn {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: var(--bg-dark);
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .refresh-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(0, 255, 255, 0.4);
        }

        .refresh-btn:active {
            transform: scale(0.95);
        }

        /* Loading Spinner */
        .spinner {
            border: 3px solid var(--border-color);
            border-top: 3px solid var(--accent-primary);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Chart styles using CSS */
        .bar-chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 200px;
            gap: 10px;
            padding: 20px 0;
        }

        .bar {
            flex: 1;
            background: linear-gradient(180deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 8px 8px 0 0;
            transition: all 0.3s ease;
            position: relative;
            min-width: 40px;
        }

        .bar:hover {
            filter: brightness(1.2);
            transform: scaleY(1.05);
        }

        .bar-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .bar-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-weight: 600;
            color: var(--accent-primary);
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    
    <div class="container">
        <!-- Header -->
        <div class="dashboard-header">
            <div class="header-content">
                <div class="header-left">
                    <h1>üíº Sage CEO Analytics Dashboard</h1>
                    <p class="header-subtitle">Fortune 500 AI Advisor - Real-time Performance Metrics</p>
                </div>
                <div class="header-right">
                    <div class="status-badge">
                        <div class="status-dot"></div>
                        <span id="systemStatus">System Operational</span>
                    </div>
                    <button class="refresh-btn" onclick="refreshDashboard()">
                        <span id="refreshIcon">üîÑ</span> Refresh Data
                    </button>
                </div>
            </div>
        </div>

        <!-- Key Metrics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üìä</div>
                <div class="stat-label">Total Queries</div>
                <div class="stat-value" id="totalQueries">0</div>
                <div class="stat-trend trend-up">
                    <span>‚Üë <span id="queriesTrend">0</span>%</span>
                    <span style="color: var(--text-secondary)">vs last week</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">‚ö°</div>
                <div class="stat-label">Avg Response Time</div>
                <div class="stat-value" id="avgResponseTime">0s</div>
                <div class="stat-trend trend-up">
                    <span>‚Üì <span id="responseTrend">0</span>ms</span>
                    <span style="color: var(--text-secondary)">improvement</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">‚≠ê</div>
                <div class="stat-label">User Satisfaction</div>
                <div class="stat-value" id="satisfaction">0%</div>
                <div class="stat-trend trend-up">
                    <span>‚Üë <span id="satisfactionTrend">0</span>%</span>
                    <span style="color: var(--text-secondary)">positive feedback</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">üéØ</div>
                <div class="stat-label">Knowledge Coverage</div>
                <div class="stat-value" id="coverage">246</div>
                <div class="stat-trend">
                    <span style="color: var(--accent-success)">Chunks Indexed</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">üî•</div>
                <div class="stat-label">Active Users</div>
                <div class="stat-value" id="activeUsers">0</div>
                <div class="stat-trend trend-up">
                    <span>‚Üë <span id="usersTrend">0</span></span>
                    <span style="color: var(--text-secondary)">this week</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">üíé</div>
                <div class="stat-label">Avg Confidence</div>
                <div class="stat-value" id="avgConfidence">0%</div>
                <div class="stat-trend trend-up">
                    <span style="color: var(--accent-primary)">High Quality</span>
                </div>
            </div>
        </div>

        <!-- Charts Row 1 -->
        <div class="charts-grid">
            <!-- Query Volume Chart -->
            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">üìà Query Volume</div>
                        <div class="chart-subtitle">Last 7 days</div>
                    </div>
                </div>
                <div class="bar-chart" id="queryVolumeChart">
                    <!-- Generated by JavaScript -->
                </div>
            </div>

            <!-- Topics Distribution -->
            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">üéØ Topics Distribution</div>
                        <div class="chart-subtitle">What users are asking about</div>
                    </div>
                </div>
                <div id="topicsChart">
                    <!-- Generated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Charts Row 2 -->
        <div class="charts-grid">
            <!-- Response Quality -->
            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">‚≠ê Response Quality Metrics</div>
                        <div class="chart-subtitle">Relevance, Authenticity, Actionability</div>
                    </div>
                </div>
                <div id="qualityMetrics">
                    <!-- Generated by JavaScript -->
                </div>
            </div>

            <!-- Performance Trends -->
            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">‚ö° Performance Trends</div>
                        <div class="chart-subtitle">Response times over time</div>
                    </div>
                </div>
                <div class="bar-chart" id="performanceChart">
                    <!-- Generated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Recent Queries Table -->
        <div class="metrics-table">
            <div class="chart-header">
                <div>
                    <div class="chart-title">üìã Recent Queries</div>
                    <div class="chart-subtitle">Latest CEO advice requests</div>
                </div>
            </div>
            <table id="recentQueriesTable">
                <thead>
                    <tr>
                        <th>Time</th>
                        <th>Query</th>
                        <th>Topics</th>
                        <th>Confidence</th>
                        <th>Response Time</th>
                        <th>User Feedback</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Generated by JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- Real-time Activity Feed -->
        <div class="charts-grid" style="margin-top: 30px;">
            <div class="realtime-feed">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">üî¥ Live Activity Feed</div>
                        <div class="chart-subtitle">Real-time query stream</div>
                    </div>
                </div>
                <div id="activityFeed">
                    <!-- Generated by JavaScript -->
                </div>
            </div>

            <!-- Success Stories -->
            <div class="realtime-feed">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">üèÜ Success Stories</div>
                        <div class="chart-subtitle">High-impact CEO advice delivered</div>
                    </div>
                </div>
                <div id="successStories">
                    <!-- Generated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // API Configuration
        const API_BASE = 'http://localhost:8000';
        
        // Dashboard Data
        let dashboardData = {
            totalQueries: 0,
            avgResponseTime: 0,
            satisfaction: 0,
            coverage: 246,
            activeUsers: 0,
            avgConfidence: 0,
            queriesTrend: 0,
            responseTrend: 0,
            satisfactionTrend: 0,
            usersTrend: 0,
            queryVolume: [],
            topics: [],
            recentQueries: [],
            activityFeed: [],
            successStories: []
        };

        // Initialize Dashboard
        async function initDashboard() {
            await checkSystemHealth();
            await loadDashboardData();
            renderDashboard();
            
            // Auto-refresh every 30 seconds
            setInterval(refreshDashboard, 30000);
        }

        // Check System Health
        async function checkSystemHealth() {
            try {
                const response = await fetch(`${API_BASE}/health`);
                const health = await response.json();
                
                document.getElementById('systemStatus').textContent = 
                    health.status === 'healthy' ? 'System Operational' : 'System Issues';
                document.getElementById('coverage').textContent = health.vector_store_chunks || 246;
                
                return health;
            } catch (error) {
                document.getElementById('systemStatus').textContent = 'System Offline';
                console.error('Health check failed:', error);
                return null;
            }
        }

        // Load Dashboard Data (Mock data for demonstration)
        async function loadDashboardData() {
            // In production, this would call actual analytics endpoints
            // For now, using realistic mock data
            
            dashboardData = {
                totalQueries: 1247,
                avgResponseTime: 1.8,
                satisfaction: 94,
                coverage: 246,
                activeUsers: 38,
                avgConfidence: 85,
                queriesTrend: 23,
                responseTrend: -150,
                satisfactionTrend: 4,
                usersTrend: 12,
                
                queryVolume: [
                    { day: 'Mon', count: 45 },
                    { day: 'Tue', count: 62 },
                    { day: 'Wed', count: 78 },
                    { day: 'Thu', count: 85 },
                    { day: 'Fri', count: 92 },
                    { day: 'Sat', count: 38 },
                    { day: 'Sun', count: 41 }
                ],
                
                topics: [
                    { name: 'IPO Preparation', count: 285, percentage: 23 },
                    { name: 'M&A Strategy', count: 267, percentage: 21 },
                    { name: 'Crisis Management', count: 198, percentage: 16 },
                    { name: 'Strategic Planning', count: 175, percentage: 14 },
                    { name: 'Leadership', count: 162, percentage: 13 },
                    { name: 'Board Management', count: 98, percentage: 8 },
                    { name: 'Fundraising', count: 62, percentage: 5 }
                ],
                
                recentQueries: [
                    {
                        time: '2 min ago',
                        query: 'How should I prepare for an IPO?',
                        topics: ['IPO', 'Fundraising'],
                        confidence: 0.92,
                        responseTime: 1.6,
                        feedback: 'Helpful'
                    },
                    {
                        time: '5 min ago',
                        query: 'What are key M&A due diligence steps?',
                        topics: ['M&A', 'Strategy'],
                        confidence: 0.88,
                        responseTime: 1.9,
                        feedback: 'Very Helpful'
                    },
                    {
                        time: '12 min ago',
                        query: 'How do I handle a data breach crisis?',
                        topics: ['Crisis', 'Security'],
                        confidence: 0.85,
                        responseTime: 2.1,
                        feedback: 'Helpful'
                    },
                    {
                        time: '18 min ago',
                        query: 'When should I pivot our business model?',
                        topics: ['Strategy', 'Leadership'],
                        confidence: 0.79,
                        responseTime: 1.7,
                        feedback: 'Helpful'
                    },
                    {
                        time: '24 min ago',
                        query: 'How do I build a high-performance board?',
                        topics: ['Governance', 'Leadership'],
                        confidence: 0.91,
                        responseTime: 1.5,
                        feedback: 'Very Helpful'
                    }
                ],
                
                activityFeed: [
                    { time: 'Just now', event: 'New query: "How to negotiate with activist investor?"', type: 'query' },
                    { time: '3 min ago', event: 'User feedback: 5-star rating on IPO advice', type: 'feedback' },
                    { time: '7 min ago', event: 'Knowledge base updated: 15 new chunks added', type: 'system' },
                    { time: '12 min ago', event: 'New user onboarded: Tech Startup CEO', type: 'user' },
                    { time: '18 min ago', event: 'Query resolved: Crisis management strategy', type: 'query' }
                ],
                
                successStories: [
                    {
                        title: 'Successful IPO Preparation',
                        description: 'Startup CEO followed Sage\'s 18-month IPO playbook, went public at $2.1B valuation',
                        metric: '$2.1B valuation',
                        time: '2 days ago'
                    },
                    {
                        title: 'M&A Deal Closed',
                        description: 'Founder used Sage\'s negotiation tactics, increased offer from $400M to $520M',
                        metric: '+$120M value',
                        time: '1 week ago'
                    },
                    {
                        title: 'Crisis Averted',
                        description: 'CEO handled data breach using Sage\'s framework, customer churn only 1.2%',
                        metric: '98.8% retention',
                        time: '2 weeks ago'
                    }
                ]
            };
        }

        // Render Dashboard
        function renderDashboard() {
            renderKeyMetrics();
            renderQueryVolumeChart();
            renderTopicsDistribution();
            renderQualityMetrics();
            renderPerformanceChart();
            renderRecentQueries();
            renderActivityFeed();
            renderSuccessStories();
        }

        // Render Key Metrics
        function renderKeyMetrics() {
            document.getElementById('totalQueries').textContent = dashboardData.totalQueries.toLocaleString();
            document.getElementById('avgResponseTime').textContent = dashboardData.avgResponseTime.toFixed(1) + 's';
            document.getElementById('satisfaction').textContent = dashboardData.satisfaction + '%';
            document.getElementById('activeUsers').textContent = dashboardData.activeUsers;
            document.getElementById('avgConfidence').textContent = dashboardData.avgConfidence + '%';
            
            document.getElementById('queriesTrend').textContent = dashboardData.queriesTrend;
            document.getElementById('responseTrend').textContent = dashboardData.responseTrend;
            document.getElementById('satisfactionTrend').textContent = dashboardData.satisfactionTrend;
            document.getElementById('usersTrend').textContent = dashboardData.usersTrend;
        }

        // Render Query Volume Chart
        function renderQueryVolumeChart() {
            const chart = document.getElementById('queryVolumeChart');
            const maxCount = Math.max(...dashboardData.queryVolume.map(d => d.count));
            
            chart.innerHTML = dashboardData.queryVolume.map(day => `
                <div class="bar" style="height: ${(day.count / maxCount) * 100}%;">
                    <div class="bar-value">${day.count}</div>
                    <div class="bar-label">${day.day}</div>
                </div>
            `).join('');
        }

        // Render Topics Distribution
        function renderTopicsDistribution() {
            const container = document.getElementById('topicsChart');
            
            container.innerHTML = dashboardData.topics.map(topic => `
                <div style="margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span style="font-weight: 600;">${topic.name}</span>
                        <span style="color: var(--accent-primary);">${topic.count} queries (${topic.percentage}%)</span>
                    </div>
                    <div style="width: 100%; height: 8px; background: var(--border-color); border-radius: 4px; overflow: hidden;">
                        <div style="width: ${topic.percentage}%; height: 100%; background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary)); transition: width 0.5s ease;"></div>
                    </div>
                </div>
            `).join('');
        }

        // Render Quality Metrics
        function renderQualityMetrics() {
            const container = document.getElementById('qualityMetrics');
            const metrics = [
                { name: 'Relevance', score: 92, target: 90 },
                { name: 'Authenticity', score: 88, target: 85 },
                { name: 'Actionability', score: 91, target: 85 },
                { name: 'CEO Voice', score: 94, target: 90 }
            ];
            
            container.innerHTML = metrics.map(metric => {
                const isAboveTarget = metric.score >= metric.target;
                const color = isAboveTarget ? 'var(--accent-success)' : 'var(--accent-warning)';
                
                return `
                    <div style="margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="font-weight: 600;">${metric.name}</span>
                            <span style="color: ${color};">${metric.score}% ${isAboveTarget ? '‚úì' : '‚Üí'} Target: ${metric.target}%</span>
                        </div>
                        <div style="width: 100%; height: 10px; background: var(--border-color); border-radius: 5px; overflow: hidden;">
                            <div style="width: ${metric.score}%; height: 100%; background: ${color}; transition: width 0.5s ease;"></div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Render Performance Chart
        function renderPerformanceChart() {
            const chart = document.getElementById('performanceChart');
            const data = [
                { label: 'Week 1', time: 2.4 },
                { label: 'Week 2', time: 2.1 },
                { label: 'Week 3', time: 1.9 },
                { label: 'Week 4', time: 1.8 }
            ];
            const maxTime = Math.max(...data.map(d => d.time));
            
            chart.innerHTML = data.map(item => `
                <div class="bar" style="height: ${(item.time / maxTime) * 100}%;">
                    <div class="bar-value">${item.time}s</div>
                    <div class="bar-label">${item.label}</div>
                </div>
            `).join('');
        }

        // Render Recent Queries
        function renderRecentQueries() {
            const tbody = document.querySelector('#recentQueriesTable tbody');
            
            tbody.innerHTML = dashboardData.recentQueries.map(query => `
                <tr>
                    <td style="color: var(--text-secondary);">${query.time}</td>
                    <td style="font-weight: 500;">${query.query}</td>
                    <td>
                        ${query.topics.map(topic => `<span class="topic-tag">${topic}</span>`).join('')}
                    </td>
                    <td>
                        <div style="width: 80px;">
                            <div style="font-size: 0.85rem; margin-bottom: 3px;">${Math.round(query.confidence * 100)}%</div>
                            <div class="confidence-bar">
                                <div class="confidence-fill" style="width: ${query.confidence * 100}%;"></div>
                            </div>
                        </div>
                    </td>
                    <td style="color: var(--accent-primary);">${query.responseTime}s</td>
                    <td style="color: var(--accent-success);">${query.feedback}</td>
                </tr>
            `).join('');
        }

        // Render Activity Feed
        function renderActivityFeed() {
            const feed = document.getElementById('activityFeed');
            
            feed.innerHTML = dashboardData.activityFeed.map(activity => `
                <div class="feed-item">
                    <div class="feed-time">${activity.time}</div>
                    <div class="feed-query">${activity.event}</div>
                    <div class="feed-meta">
                        <span>Type: ${activity.type}</span>
                    </div>
                </div>
            `).join('');
        }

        // Render Success Stories
        function renderSuccessStories() {
            const stories = document.getElementById('successStories');
            
            stories.innerHTML = dashboardData.successStories.map(story => `
                <div class="feed-item" style="border-left-color: var(--accent-success);">
                    <div class="feed-time">${story.time}</div>
                    <div class="feed-query" style="color: var(--accent-success);">${story.title}</div>
                    <div style="margin: 8px 0; color: var(--text-secondary);">${story.description}</div>
                    <div class="feed-meta">
                        <span style="color: var(--accent-primary); font-weight: 600;">${story.metric}</span>
                    </div>
                </div>
            `).join('');
        }

        // Refresh Dashboard
        async function refreshDashboard() {
            const refreshIcon = document.getElementById('refreshIcon');
            refreshIcon.innerHTML = '<div class="spinner"></div>';
            
            await checkSystemHealth();
            await loadDashboardData();
            renderDashboard();
            
            refreshIcon.textContent = 'üîÑ';
        }

        // Initialize on page load
        window.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>
</html>

